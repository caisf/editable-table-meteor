$.fn.editableTableWidget=function(e){"use strict";return $(this).each(function(){var t=function(){var e=$.extend({},$.fn.editableTableWidget.defaultOptions);e.editor=e.editor.clone();return e},n=$.extend(t(),e),r=37,i=38,s=39,o=40,u=13,a=27,f=9,l=$(this),c=n.editor.css("position","absolute").hide().appendTo(l.parent()),h,p=function(e){h=l.find("td:focus");if(h.length){c.val(h.text()).removeClass("error").show().offset(h.offset()).css(h.css(n.cloneProperties)).width(h.width()).height(h.height()).focus();if(e){c.select()}}},d=function(){var e=c.val(),t=$.Event("change"),n;if(h.text()===e||c.hasClass("error")){return true}n=h.html();h.text(e).trigger(t,e);if(t.result===false){h.html(n)}},v=function(e,t){if(t===s){return e.next("td")}else if(t===r){return e.prev("td")}else if(t===i){return e.parent().prev().children().eq(e.index())}else if(t===o){return e.parent().next().children().eq(e.index())}return[]};c.blur(function(){d();c.hide()}).keydown(function(e){if(e.which===u){d();c.hide();h.focus();e.preventDefault();e.stopPropagation()}else if(e.which===a){c.val(h.text());e.preventDefault();e.stopPropagation();c.hide();h.focus()}else if(e.which===f){h.focus()}else if(this.selectionEnd-this.selectionStart===this.value.length){var t=v(h,e.which);if(t.length>0){t.focus();e.preventDefault();e.stopPropagation()}}}).on("input paste",function(){var e=$.Event("validate");h.trigger(e,c.val());if(e.result===false){c.addClass("error")}else{c.removeClass("error")}});l.on("click keypress dblclick",p).css("cursor","pointer").keydown(function(e){var t=true,n=v($(e.target),e.which);if(n.length>0){n.focus()}else if(e.which===u){p(false)}else if(e.which===17||e.which===91||e.which===93){p(true);t=false}else{t=false}if(t){e.stopPropagation();e.preventDefault()}});l.find("td").prop("tabindex",1);$(window).on("resize",function(){if(c.is(":visible")){c.offset(h.offset()).width(h.width()).height(h.height())}})})};$.fn.editableTableWidget.defaultOptions={cloneProperties:["padding","padding-top","padding-bottom","padding-left","padding-right","text-align","font","font-size","font-family","font-weight","border","border-top","border-bottom","border-left","border-right"],editor:$("<input>")}
